var e=Object.defineProperty,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,a=(t,o,l)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[o]=l,n=(e,n)=>{for(var r in n||(n={}))o.call(n,r)&&a(e,r,n[r]);if(t)for(var r of t(n))l.call(n,r)&&a(e,r,n[r]);return e};import{computed as r,ref as i,nextTick as d,watch as s,defineComponent as c,useCssVars as u,openBlock as g,createBlock as v,Transition as p,withCtx as m,createElementBlock as f,normalizeClass as y,normalizeStyle as b,createCommentVNode as h,renderSlot as k,onBeforeUnmount as w,resolveComponent as S,Fragment as C,normalizeProps as B,guardReactiveProps as x,Teleport as E,createVNode as N,withDirectives as O,createElementVNode as D,vShow as I,inject as G,renderList as V,resolveDynamicComponent as A,mergeProps as R,reactive as T,shallowRef as q}from"vue";const z=(e,t="px")=>null==e||""===e?void 0:isNaN(+e)?String(e):`${Number(e)}${t}`,W=e=>{if(!e||e.nodeType!==Node.ELEMENT_NODE)return 0;const t=parseInt(window.getComputedStyle(e).getPropertyValue("z-index"));return t||W(e.parentNode)},Z=({activeElSelector:e,stackMinZIndex:t=0,isActive:o,content:l})=>({activeZIndex:r((()=>{if(!l.value)return 0;const a=o.value?((o=[])=>{const l=[t],a=document.querySelectorAll(e);for(let e=0;e<a.length;e++)o.includes(a[e])||l.push(W(a[e]));return Math.max(...l)})([l.value])+2:W(l.value);return null===a?0:a}))}),L=e=>{if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return["auto","scroll"].includes(t.overflowY)&&e.scrollHeight>e.clientHeight},M=(e,t)=>0===e.scrollTop&&t<0||e.scrollTop+e.clientHeight===e.scrollHeight&&t>0,P=(e,t)=>{const o=(e=>{if(e.composedPath)return e.composedPath();const t=[];let o=e.target;for(;o;){if(t.push(o),"HTML"===o.tagName)return t.push(document),t.push(window),t;o=o.parentElement}return t})(e),l=e.deltaY;for(let a=0;a<o.length;a++){const e=o[a];if(e===document)return!0;if(e===document.documentElement)return!0;if(e===t)return!0;if(L(e))return M(e,l)}return!0},$=({overlay:e,content:t,contentActiveClass:o,fullscreen:l,contentFullscreenClass:a})=>{let n,r=!1;const i=o=>{(o.target===e.value||o.target===document.body||P(o,t.value))&&o.preventDefault()},d=0===(()=>{const e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll";const t=document.createElement("div");e.appendChild(t),document.body.appendChild(e);const o=e.offsetWidth-t.offsetWidth;return document.body.removeChild(e),o})();return{disableScroll:()=>{r||(d||l?(n="byOverflow",document.documentElement.classList.add("overflow-y-hidden")):(n="byEvents",window.addEventListener("wheel",i,{passive:!1})),r=!0)},enableScroll:()=>{if(r){if("byEvents"===n)window.removeEventListener("wheel",i);else if("byOverflow"===n){const e=document.getElementsByClassName(o),t=document.getElementsByClassName(a);(!d&&l&&1===t.length||1===e.length)&&document.documentElement.classList.remove("overflow-y-hidden")}r=!1}}}},H=c({name:"GDialogOverlay",props:{active:{type:Boolean,required:!0},activeZIndex:{type:Number,required:!0},deactivating:{type:Boolean,required:!0},background:{type:[Boolean,String],required:!0}},emits:["click"],setup:(e,{emit:t})=>({styles:r((()=>({zIndex:e.activeZIndex-1}))),classes:r((()=>["g-dialog-overlay",{"g-dialog-overlay--active":e.active&&!e.deactivating}])),computedBackground:r((()=>"string"==typeof e.background?e.background:e.background?"var(--overlay-bg)":"transparent")),onClick:()=>{t("click")}})}),_=()=>{u((e=>({"01729808":e.computedBackground})))},j=H.setup;H.setup=j?(e,t)=>(_(),j(e,t)):_;H.render=function(e,t,o,l,a,n){return g(),v(p,{name:"fade"},{default:m((()=>[e.active?(g(),f("div",{key:0,class:y(e.classes),style:b(e.styles),onClick:t[0]||(t[0]=(...t)=>e.onClick&&e.onClick(...t))},null,6)):h("",!0)])),_:1})};const F=c({name:"GDialogContent",props:{background:{type:[Boolean,String],required:!0},borderRadius:{type:[Boolean,Number,String],required:!0},class:{type:String,default:""},depressed:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},height:{type:[String,Number],required:!0},maxWidth:{type:[String,Number],default:"none"},scrollable:{type:Boolean,default:!1},width:{type:[String,Number],default:"auto"}},setup(e){const{sizeStyles:t}=(e=>({sizeStyles:r((()=>({maxWidth:"none"===e.maxWidth?void 0:z(e.maxWidth),width:"auto"===e.width?void 0:z(e.width),height:"auto"===e.height?void 0:z(e.height)})))}))(e);return{styles:t,classes:r((()=>["g-dialog-content",e.class,{"g-dialog-content--scrollable":e.scrollable,"g-dialog-content--depressed":e.depressed,"g-dialog-content--fullscreen":e.fullscreen,"g-dialog-content--no-bg":e.background}])),computedBackground:r((()=>"string"==typeof e.background?e.background:e.background?"var(--content-bg)":"transparent")),computedBorderRadius:r((()=>"string"==typeof e.borderRadius?z(e.borderRadius):e.borderRadius?"var(--content-border-radius)":"0"))}}}),U=()=>{u((e=>({"1982450c":e.computedBackground,"26986c3c":e.computedBorderRadius})))},Y=F.setup;F.setup=Y?(e,t)=>(U(),Y(e,t)):U;F.render=function(e,t,o,l,a,n){return g(),f("div",{class:y(e.classes),style:b(e.styles)},[k(e.$slots,"default")],6)};var J=c({name:"GDialog",components:{GDialogOverlay:H,GDialogContent:F},props:{background:{type:[Boolean,String],default:!0},borderRadius:{type:[Boolean,Number,String],default:!0},contentClass:{type:String,default:""},depressed:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},height:{type:[String,Number],default:"auto"},maxWidth:{type:[String,Number],default:"none"},modelValue:{type:Boolean,default:!1},overlayBackground:{type:[Boolean,String],default:!0},persistent:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},transition:{type:String,default:"g-dialog-transition"},width:{type:[String,Number],default:"auto"}},emits:{"update:modelValue":e=>!0},setup(e,{emit:t}){const o=i(),l=i(),a=r((()=>{var e;return null==(e=l.value)?void 0:e.$el})),n=i(e.modelValue);s((()=>e.modelValue),(e=>{n.value=e}));const{activatedOnce:c,active:u,deactivating:g}=(e=>{const t=i(!1),o=i(!1),l=i(!1);return e.value&&(t.value=!0,d((()=>{o.value=!0}))),s((()=>e.value),(e=>{if(!e)return l.value=!0,void d((()=>{o.value=e,l.value=!1}));t.value?o.value=e:(t.value=!0,d((()=>{o.value=e})))})),{activatedOnce:t,active:o,deactivating:l}})(r((()=>n.value))),{activeZIndex:v}=Z({activeElSelector:".g-dialog-frame--active",stackMinZIndex:200,isActive:u,content:o}),p=r((()=>["g-dialog-frame",{"g-dialog-frame--active":u.value,"g-dialog-frame--fullscreen":e.fullscreen}])),m=r((()=>({zIndex:v.value}))),{enableScroll:f,disableScroll:y}=$({overlay:a,content:o,contentActiveClass:"g-dialog-frame--active",fullscreen:e.fullscreen,contentFullscreenClass:"g-dialog-frame--fullscreen"});s(u,(e=>{e?y():f()})),w((()=>{f()}));return{onClickOutside:()=>{e.persistent||(n.value=!1,t("update:modelValue",!1))},activatedOnce:c,activeZIndex:v,isActive:u,deactivating:g,classes:p,styles:m,contentFrame:o,overlay:l,activatorAttrs:{onClick(){n.value=!0,t("update:modelValue",!0)}}}}});J.render=function(e,t,o,l,a,n){const r=S("GDialogOverlay"),i=S("GDialogContent");return g(),f(C,null,[k(e.$slots,"activator",B(x(e.activatorAttrs))),e.activatedOnce?(g(),v(E,{key:0,to:"body"},[N(r,{ref:"overlay",active:e.isActive,deactivating:e.deactivating,"active-z-index":e.activeZIndex,background:e.overlayBackground,onClick:e.onClickOutside},null,8,["active","deactivating","active-z-index","background","onClick"]),N(p,{name:e.transition},{default:m((()=>[O(D("div",{ref:"contentFrame",class:y(e.classes),style:b(e.styles)},[N(i,{class:y(e.contentClass),"max-width":e.maxWidth,width:e.width,height:e.height,scrollable:e.scrollable,depressed:e.depressed,fullscreen:e.fullscreen,background:e.background,"border-radius":e.borderRadius},{default:m((()=>[k(e.$slots,"default")])),_:3},8,["class","max-width","width","height","scrollable","depressed","fullscreen","background","border-radius"])],6),[[I,e.isActive]])])),_:3},8,["name"])])):h("",!0)],64)};var K={name:"GDialogRoot",setup(){const{dialogs:e,removeDialog:t}=G(ee);return e||console.error("The giart-vue-dialog plugin is not initialized"),{dialogs:e,onClose:function(e){t(e)}}}};K.render=function(e,t,o,l,a,n){return g(!0),f(C,null,V(l.dialogs,((e,t)=>(g(),v(A(e.component),R({key:e.id},e.props,{"onUpdate:modelValue":e=>l.onClose(t)}),null,16,["onUpdate:modelValue"])))),128)};const Q=T([]),X={dialogs:Q,addDialog:({component:e,props:t})=>{Q.push({component:q(e),id:Date.now()+Math.random(),props:n({modelValue:!0},t)})},removeDialog:e=>{Q[e].props.modelValue=!1,setTimeout((()=>{Q.splice(e,1)}),150)}},ee=Symbol("GDialog"),te={install:e=>{e.provide(ee,X),e.config.globalProperties.$dialog=X}};export{J as GDialog,K as GDialogRoot,ee as dialogInjectionKey,te as plugin};
